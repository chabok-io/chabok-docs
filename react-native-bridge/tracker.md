---  
id: tracker  
title: ترکر نصب  
layout: react-native-bridge  
permalink: react-native-bridge/tracker.html  
prev: sdk-setup.html  
next: chabok-messaging.html  
---  

## شروع به کار
---

برای استفاده از چابک در اجرای کمپین‌های خود باید در ابتدا باید **SDK** چابک را اپلیکیشن یا وب سایت خود پیاده کنید. برای مشاهده مستندات فنی [اینجا](/react-native-bridge/sdk-setup.html) را کلیک کنید.

### ساخت ترکر

قبل از ساختن ترکر بهتر است با انواع آن آشنا شویم:

### انواع ترکر

- ترکرهای ساده

این نوع ترکرها در هر جایی قابل استفاده هستند و شما می‌توانید تمامی موارد از قبل تنظیم شده را در اینجا بشمارید.

-  ترکرهای نتورک‌های خاص (شبکه‌های تبلیغاتی)

در صورتی که بخواهید با یک اد نتورک خاص در ایران، کمپین تبلیغات اجرا کنید، چابک می‌تواند برای بهبود کیفیت کمپین شما پارامترهای مورد نظر اد نتورک را به آنها بدهد تا بتوانند با استفاده از این کمپین‌ها کیفیت کمپین شما را بهتر کنند.

- ترکر گوگل ادز

چابک می‌تواند به شما کمک کند که نصب‌هایی که از طریق گوگل ادز یا UAC (Universal Ad Campaign) اجرا می‌کنید را بررسی کنید.
  
- ترکر کافه بازار

چابک می‌تواند به شما کمک کند که نصب‌هایی که از طریق کافه بازار یا تپسل اجرا می‌کنید را بررسی کنید.

### مراحل ساخت یک ترکر

ساخت ترکر از طریق پنل انجام می‌شود. برای مشاهده نحوه ساخت ترکر می‌توانید به [مستندات پنل](/panel/tracker.html#%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF-%D8%AA%D8%B1%DA%A9%D8%B1) مراجعه کنید.

**نمونه لینک ترکر چابک**:  
  
حساب‌ رایگان:  
  
```javascipt  
https://sand.chabok.io/JY@4sc  
```    
حساب عملیاتی:  
  
```javascipt  
https://a.chabok.io/JY@4sc  
```    
<br>

#### سطح بندی ترکر

برای اینکه بتوانید به کمپین‌های خود نظم و دقت بیشتری بدهید تا در هنگام بررسی آمارها تحلیل‌های درست‌تری داشته باشید باید بتوانید ترکر خود را به شکل اصولی سطح بندی کنید.

<br><br>

## رصد رویدادها (رفتار یا اهداف تبلیغ)
---
برای پیاده‌سازی به صفحه [رصد رفتار درون‌برنامه‌ای](/react-native-bridge/behavior-tracking.html) مراجعه کنید. پس از آن با انواع رویداد‌ها در چابک آشنا می‌شویم:

### ۱. رویداد‌های سیستمی (پیش‌فرض در چابک)

رویداد‌هایی که به طور پیش فرض بدون نیاز به پیاده‌سازی خاصی تنها با استفاده از چابک بررسی می‌شوند. مثلا اولین ورود، اطلاعات گوشی و… .

<br>

### ۲. رویداد‌های غیر سیستمی یا سفارشی (Custom Events)

این رویداد‌ها **توسط شما تعریف و پیاده‌سازی می‌شوند**. شما می‌توانید تا سقف ۳۰۰ رویداد و ۱۰۰ زیر رویداد یا اتریبیوت در اپلیکیشن خود داشته باشید.

یکی از مهم‌ترین بخش‌هایی که می‌تواند به شما در تحلیل اپ به شما کمک کند، رویداد‌های سفارشی است. هرچه آن‌ها دقیق‌تر انتخاب شوند، می‌توانند به شما کمک کنند تا بتوانید هم رفتار کاربران را به درستی تحلیل کنید و هم بتوانید در زمان تعامل مجدد (re-engage) با آن‌ها موثرتر عمل کنید.

> `نکته:` اگر از CPA/CPO (یا در کل **رویدادهایی که خارج از اپلیکیشن رخ می‌دهند** مانند خرید) استفاده می‌کنید، دقت کنید که حتما از [وب‌سرویس چابک](/rest-api/send-event.html#%D8%A7%D8%B1%D8%B3%D8%A7%D9%84-%D8%B1%D9%88%DB%8C%D8%AF%D8%A7%D8%AF-track) استفاده کنید. 

<br><br>

#### پیاده‌سازی شمارش نصب از گوگل پلی

برای انجام این کار باید از `INSTALL_REFERRER` intent اندروید استفاده کنید. این Referrer وظیفه اطلاع رسانی نصب از گوگل پلی را  به SDK چابک دارد. فقط کافیست اپلیکیشن شما آن را دریافت کند. بنابراین اطمینان یابید که کد زیر در `build.gradle` شما اضافه شده باشد:  
  
```java  
implementation 'com.android.installreferrer:installreferrer:1.0'  
```  

<br>  

#### پیاده‌سازی شمارش نصب از استورهای غیر از گوگل پلی  (Third-Party App Stores)  
  
این کار را چابک با دو روش **استفاده از روش Referrer** و **آی‌دی ترکر** انجام می‌دهد.   
  
##### روش Referrer  
  
در صورتی که می‌خواهید از استورهای غیر از گوگل پلی که Referrer را **پشتیبانی می‌کنند** ترک کنید، تگ `receiver` را در کلاس `application` فایل `AndroidManifest.xml` خود قرار دهید:   
  
```java  
<receiver  
    android:name="com.adpdigital.push.ChabokReferrerReceiver"  
    android:permission="android.permission.INSTALL_PACKAGES"  
    android:exported="true">  
       <intent-filter>  
            <action android:name="com.android.vending.INSTALL_REFERRER" />  
        </intent-filter>  
</receiver>  
```  
  
زمانی که شما دریافت Referrer را در اپلیکیشن خود پیاده‌سازی کردید، اطلاعات کمپین را دریافت می‌کند و به شما انتقال خواهد داد.  
  
از طریق Referrer شما اطلاعات کلیدی ترکر خود مانند منبع نصب، آی‌دی ترکر و سطح ترکر را ارسال می‌کنید.  
  
##### روش آی‌دی یا دیفالت ترکر (Pre-Install Campaigns)  
 
اگر هم استورها Referrer را کلا **پشتیبانی نکنند** شما همچنان می‌توانید منبع (Source) نصب را در کمپین خود برای اندروید و آی‌اواس بفهمید. برای انجام این کار باید در ابتدا ترکر خود را در پنل ایجاد کنید و **آی‌دی ترکر** را در کد apk یا ipa خود قرار دهید.


```javascript
this.chabok.setDefaultTracker("YOUR_TRACKER_ID");
```

>`نکته:` دقت داشته باشید که `TRACKER_ID` شناسه ۶ کاراکتری است که در لینک ترکر شما وجود دارد. به عنوان مثال در لینک `https://sand.chabok.io/JY@4sc` آی‌دی ترکر `JY@4sc` می‌باشد. این آی‌دی را می‌توانید از پنل>ترکر>جزئیات ترکر مانند تصویر زیر کپی کنید:

![عکس مربوط](http://uupload.ir/files/bjbc_tracker-analytics-s.png)

<br><br>

#### شمارش جستجوی ارگانیک گوگل  
  
گوگل به کاربران امکان می‌دهد تا با جستجوی اپلیکیشن در موتور جستجوی خود و کلیک روی آیکون آن به **گوگل پلی** بروند و آنجا به طور مستقیم نصب کنند.  
  
شما می‌توانید **کلید واژه‌‌ای** که کاربر در **گوگل** جستجو کرده است را داشته باشید. چابک این کلید واژه را در سطح `campaign` ترکر ایجاد می‌کند.   
  
علاوه بر آن، چابک پارامتر `utm_medium` را در سطح `adgroup` ایجاد می‌کند. این پارامتر همان معیار شمارش است.  
  
>`نکته:` دقت داشته باشید که برای استفاده از این قابلیت باید حتما ‍‍`referrer` را پیاده‌سازی کرده باشید. 


<br><br>
      
### کال‌بک‌های ترکر (Callback)  
--- 

در صورتی هم که می‌خواهید داده‌های ترکر را در سیستم‌های دیگر از جمله سرورهای خود دریافت کنید می‌توانید از کال‌بک استفاده کنید. این کار را می‌توانید از پنل هنگام ایجاد ترکر جدید انجام دهید. به این ترتیب لینکی که می‌خواهید زمان رخ دادن رویداد (کلیک یا نصب) فرخوانی شود را وارد می‌کنید.   
  
همچنین شما می‌توانید در کال‌بک خود از پارامترهایی برای اطلاعات بیشتر از مبدا رویداد کسب کنید. برای مشاهده این پارامترها و نمونه لینک کال‌بک می‌توانید به مستندات [پنل](/panel/tracker.html#کالبک) مراجعه کنید.  

<br><br>

### قابلیت دعوت دوستان
 ---  
  
یکی از راههای موثر برای جذب کاربران به اپلیکیشن، ارسال لینک دعوت به آن‌هاست. روش‌های زیادی برای ارسال لینک دعوت به کاربران وجود دارد که  برای مثال یک نمونه از آن را توضیح خواهیم داد.     
    
فرض کنید یک تعداد از کاربران، اپلیکیشن شرکت در رویداد را نصب  و در رویدادی ثبت نام کردند، برای جذب کاربران بیشتر در اپلیکیشن نیازست لینک دعوتی به آن‌ها ارسال کنید تا لینک را با دوستان خود به اشتراک بگذارند، با کلیک کاربران جدید بر روی لینک دعوت  به صفحه نصب اپلیکیشن به طور خودکار هدایت می‌شوند و به طور مثال کاربران دعوت‌کننده نیز کد تخفیفی برای شرکت در رویدادهای بعدی دریافت خواهند کرد.     
    
<h4>ایجاد لینک دعوت دوستان</h4>    

 برای ایجاد لینک دعوت دوستان از طریق خود اپلیکیشن کافیست در انتهای لینک ترکر نصب، پارامتر `lable` را اضافه کنید.    
    
- اندروید:
 
برای اینکه در اندروید متوجه شوید نصب اپلیکیشن انجام شده و دعوت‌نامه  به کاربر دیگر ارسال شده، نیاز به فراخوانی متد `setDeferredDataListener` و پیاده‌سازی متد `onReferralReceived` به کمک کد زیر را دارید.    
    
    
```java    
AdpPushClient.get().setDeferredDataListener(new DeferredDataListener() {    
    @Override    
    public boolean launchReceivedDeeplink(Uri deeplink) {    
        return false;    
    }    
    
    @Override    
    public void onReferralReceived(String label) {    
        // send label to your server    
    }    
});    
```    

- آی‌اواس:

برای اینکه در آی‌اواس متوجه شوید نصب اپلیکیشن انجام شده و دعوت‌نامه  به کاربر دیگر ارسال شده، نیاز به پیاده‌سازی متد `chabokReferralResponse:(NSString *)referralId` به کمک کد زیر را دارید.  
  
{% tabs %}  
{% tab OBJECTIVE-C %}  
  
```objectivec  
-(void) chabokReferralResponse:(NSString *)referralId {  
 // received referralId}  
```  
{% endtab %}  
{% tab SWIFT %}  
  
```swift  
func chabokReferralResponse(_ referralId: String!) {  
 // received referralId}  
```  
{% endtab %}  
{% endtabs %}
    
>`نکته`: **lable** مقداری هست که در انتهای لینک ترکر نصب گذاشته می‌شود و با هر بار کلیک کاربر بر روی لینک، کاربر به صفحه نصب اپلیکیشن هدایت می‌شود. این مقدار از طریق فراخوانی متد گفته شده قابل دریافت است.    
    
    
 اگر قصد دارید لینک دعوت به دوستان را در حساب آزمایشی به کاربران ارسال کنید، کافیست لینک ترکر خود را به فرمت زیر در اپلیکیشن‌تان استفاده کنید.    
    
```java    
https://sand.chabok.io/GgKoAT?label=user_1001    
```    
اگر در حساب عملیاتی، خواستید لینک را به کاربران ارسال کنید باید از فرمت زیر در اپلیکیشن‌‌تان استفاده کنید.    
    
```java    
https://a.chabok.io/GgKoAT?label=user_1001    
```    
    
>`نکته`: برای پیاده‌سازی قابلیت دعوت دوستان کافیست در انتهای لینک ترکر نصب به جای user_1001، شناسه کاربری شخص دعوت‌کننده را قرار دهید.   

<br><br>
  
### مکانیزم ضد تقلب (Fraud Prevention)  
---

SDK چابک به گونه‌ای پیاده‌سازی شده است که امکان تقلب و نصب غیر واقعی در روش‌های مبتنی بر نصب و رفتار (CPA و CPI) را به طور کامل از بین می‌برد. علاوه بر آن، به هیج وجه فراخوانی و رصد رویداد‌های چابک قابل دستکاری نیستند.   
  
مواردی که چابک برای حذف تقلب انجام می‌دهد عبارتند از:  
  
- **IP Filtering**:  
  
آی‌پی کاربر را در زمان کلیک و نصب تطبیق می‌دهد، جلوی نصب‌های متعدد با یک آی‌پی را می‌گیرد و همچنین آی‌پی‌های ناشناخته را رد می‌کند.  
  
- **User Verification**:  
  
با توجه به ساختار کاربر محور بودن سیستم چابک، تمام اطلاعات کاربر در کلیک و نصب را مقایسه می‌کند تا واقعی بودن کاربر جذب شده مشخص شود.  
  
- **SDK Signature**:  
  
روی SDK امضای خاصی را می‌گذارد تا هنگام کلیک دریافت شود و پس از نصب با اپلیکیشن شما تطبیق داده شود. همچنین یکی از راه‌های مقابله با **SDK Spoofing** است. SDK Spoofing یکی از راه‌های تقلب است که نصب‌ها را روی دستگاه‌های واقعی شبیه‌سازی می‌کند و آن را جزو نصب‌های کمپین محاسبه می‌نماید. این کار معمولا از اپلیکیشن‌های دیگر روی دستگاه صورت می‌گیرد و نصب‌های بی‌شمار غیر واقعی را وارد کمپین‌ شما می‌کند.  
  
  
- **Server to Server Verification**:  
  
اطلاعات کاربر را هنگام کلیک جمع‌آوری می‌کند و با اطلاعاتی که سرور شما در هنگام نصب دریافت می‌کند اعتبارسنجی می‌نماید؛ در صورت عدم تطابق، نصب را رد می‌کند.  
  
- **TTI**:  
  
زمان قابل قبول بین کلیک و نصب است. چابک به طور خودکار فاصله زمانی بسیار کوتاه را رد می‌کند و همینطور در صورتی که از محدوده‌ای که شما تعیین کرده‌اید بیشتر شود ([محدوده اتریبیوشن](/panel/tracker.html#محدوده-اتریبیوشن))، نصب شمرده نخواهد شد.  
  
- **Two-Phase Authentication**:  
  
احراز هویت برای تشخیص واقعی بودن کاربر در هنگام نصب است. در چابک این کار از طریق ارسال پیام کوتاه انجام می‌شود.  
