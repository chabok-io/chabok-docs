---
id: Send-smart-message
title: وب سرویس ارسال پیام هوشمند از سمت سرور
layout: rest-api
permalink: rest-api/Send-smart-message.html
---

شما می‌توانید با فراخوانی این وب‌ سرویس، **پیام هوشمند** را به سرور چابک ارسال کنید.

<Br>

### لینک پایه (Path)

لینک پایه ارسال رویداد**post** `https://{APP_ID}.push.adpdigital.com/api/push/notifyToUsers`
است.


<Br>

### مثال ارسال پیام هوشمند به سرور چابک از طریق شناسه در چابک 


```java
{
  "user": "userId",
  "content": "MESSAGE TEXT",
  "ttl": 60,
  "fallback": {
    "content": "SMS Content",
    "delay": 60,
    "media": "sms",
    "policy": "NOTIFICATION_SHOWN"
  },
  "notification": {
    "title": "title",
    "body": "body"
  }
}
```

-  ``user`` (اجباری)

شناسه کاربری که پیام هوشمند را دریافت می‌کند.

>`نکته`: اگر کاربر با یک دستگاه وارد اپلیکیشن شما شده باشد، پیام هوشمند به آن دستگاه ارسال می‌شود اما اگر کاربر با چندین دستگاه وارد اپلیکیشن شده باشد، پیام هوشمند به تمام دستگاه‌ها ارسال می‌شود.


- ``content`` (اجباری)

محتوای اصلی پیام را به عنوان مقدار **content** ارسال کنید،

>`نکته`: **content** زمانی به کاربران نمایش داده می‌شود که محتوای اس‌ام‌اس و نوتیفیکیشن خالی باشند در غیر این صورت از این محتوا استفاده نمی‌شود 

- `ttl` (اختیاری)

زمانی که کمپینی را ارسال می‌کنید باید انقضای پیام را به عنوان مقدار **ttl** بر اساس ثانیه ارسال کنید.

>`مثال`: فرض کنید قصد دارید کمپینی به کاربران‌تان ارسال کنید و بعد از ۶۰ ثنیه، دیگر کاربران کمپینی را دریافت نکنند، در این صورت تاریخ انقضای پیام را بر روی ۶۰ ثانیه قرار می‌دهید و بعد از آن، دیگر کمپینی به کاربران ارسال نمی‌شود. 


 `fallback` 

  - `content`(اختیاری)
 
متن پیام اس‌ام‌اس را به عنوان مقدار **content** ارسال کنید، 
 
 >`نکته`: 
 
   -  `delay`(اجباری)
   
مدت زمان تاخیر ارسال پیام به عنوان مقدار **delay** و بر اساس ثانیه ارسال کنید. 
  
به عنوان مثال در صورتی که ۶۰ ثانیه از زمان ارسال پیام گذششته باشد و نوتیفیکیشن در این زمان به کاربر ارسال نشده باشد، به طور خودکار اس‌ام‌‌اس به کاربر ارسال می‌شود. -
  
  -  `media`(اجباری)
  
**media** .نوع کمپینی که به کاربران ارسال می‌شود از نوع اس‌ام‌اس یا ایمیل است.
  
  -  `policy`
  
سیاست ارسال پیام در فال‌بک بر روی نوتیفیکیشن قرار دارد،
  
`notification`

  - `title`(اجباری)
  
عنوان نوتیفیکیشن به عنوان مقدار **title** ارسال می‌شود.

  - `body`(اختیاری)
 
بدنه نوتیفیکیشن به عنوان مقدار **body** ارسال می‌شود. 
  
به طور مثال این پیام توسط chabok.io ارسال شده است. 
  
>`نکته`: اولویت ارسال کمپین به کاربران با نوتیفیکیشن است. در صورت وجود مشکل در ارسال کمپین از طریف نوتیفیکیشن،، پیام به طور خودکار از طریق اس‌ام‌اس به کاربران ارسال می‌شود. 
  
### دسترسی به شماره تلفن کاربران برای ارسال کمپین

اگر از طریق نوتیکیفیکیشن نتوانستید پیامی به کاربران ارسال کنید به طور خودکار از طریق اس‌ام‌اس پیام به کاربر ارسال می‌شود، که برای اسرال اس‌ام‌اس نیاز به شماره تلفن کاربران خواهید داشت که به یکی از دو روش زیر می‌توانید به آن دسترسی داشته باشید.

۱. دست‌یابی به شماره تلفن کاربر از طریق اطلاعات کاربر

شماره تلفن کاربر از طریق بخش اطلاعات کاربران (user attribute) قابل مشاهده است. البته در صورتی که در اطلاعات کاربران، شماره تلفن را به عنوان **phone** سیو کرده باشید.

در غیر این صورت:

۲. اگر کاربر **userID** خود را با شماره تلفن سیو کرده باشد.

در قسمت **userID** شماره تلفن کاربر با پسوند پیش‌فرض ۹۸ شروع می‌شود.

>`نکته`: در صورتی که کاربر در قسمت **phone بخش اطلاعات کاربر**، شماره تلفنی سیو  کرده باشد و **userID** خودش را هم با شماره تلفن ذخیره کره باشد، (حتی اگر شماره تلفن‌ها متفاوت باشد)، پیام به شماره تلفنی ارسال می‌شود که از بخش اطلاعات کاربر، ذخیره شده است. 
>`نکته`: برای ارسال ایمیل هم اولویت با آدرس ایمیلی است که در اطلاعات کاربر وجود دارد نه **userID**.