---  
id: tracker  
title: ترکر نصب  
layout: android  
permalink: android/tracker.html  
prev: sdk-setup.html  
next: chabok-messaging.html  
---  

## مفاهیم اولیه
---

### ترکر

در موبایل مارکتینگ **لینکی** است که همراه کمپین‌های تبلیغاتی گذاشته می‌شود تا عملکرد آن‌ها را ارزیابی کند. 
 به عبارت دیگر ابزاری است که به بازاریاب‌ها کمک می‌کند تا بتوانند کمپین‌های تبلیغاتی خودشان را در کانال‌های مختلفی منتشر کنند و عملکرد هر کدام رو جدا بررسی کنند.

  
نباید به یک ترکر تنها به عنوان یک ابزار شمارشی نگاه کرد. یک ترکر می‌تواند کمک کند تا بتوانید ارزش هر شبکه تبلیغاتی را بهتر بشناسید و تصمیم بگیرید که بودجه خود را چگونه می‌توانید بهینه‌تر خرج کنید.

 به عنوان مثال در نظر بگیرید که دو شبکه تبلیغاتی الف و ب برای شما کمپین اجرا کرده‌اند. شبکه تبلیغاتی الف به شما تعداد نصب خیلی کمتری نسبت به شبکه تبلیغاتی ب می‌دهد، اما شبکه تبلیغاتی الف درآمد بیشتری نسبت به شبکه تبلیغاتی ب تولید کرده است. در نگاه اول درست است که شمارش نصب کمپین ب بیشتر بوده است و بهتر است که با شبکه تبلیغاتی ب ادامه بدهید اما وقتی آمار **KPIهای کلیدی** را مشاهده می‌کنید، شبکه تبلیغاتی الف ارزشمند‌تر است هرچند تعداد نصب کمتری نسبت به شبکه تبلیغاتی ب داشته است.
 
<br>

### اتریبیوشن

به فرایند **نسبت دادن** یک عمل رخ داده در اپلیکیشن (نمایش، کلیک، نصب، اولین باز شدن اپ و…) به یک ترکر، اتریبیوشن گفته می‌شود.

<br>

### مفهوم نصب در چابک

در چابک نصب زمانی شمرده می‌شود که کاربر علاوه بر نصب، اپلیکیشن شما را برای **اولین بار باز کند**. این شیوه شمارش باعث می‌شود تا کیفیت نصب‌هایی که دریافت می‌کنید بالاتر برود.

<br>

### نصب‌های رد شده یا تقلبی (Fraud)

در چابک همه نصب‌ها مورد قبول نیستند. بعضی از نصب‌ها به خاطر رفتار مشکوک و غیر طبیعی رد می‌شوند (نصب شمرده نمی‌شوند یا به ترکر ارگانیک نسبت داده می‌شوند و در واقع به هیچ ترکری نسبت داده نمی‌شوند). برای مطالعه بیشتر [اینجا](/android/tracker.html#مکانیزم-ضد-تقلب-fraud-prevention) را کلیک کنید.

<br>

### نصب‌ یا اتریبیوشن مجدد (Re-attribution)

به بازگرداندن یک کاربر پس از مدت قابل توجهی از عدم فعالیت و یا پاک کردن اپلیکیشن، اتریبیوشن مجدد گفته می‌شود.

<br>

### نصب‌های ارگانیک

به طور کلی نصبی که هیچ کمپینی (ترکری) عامل آن نباشد، ارگانیک گفته می‌شود. این دسته از نصب‌ها نسبت به بقیه کیفیت بالاتری دارند زیرا که کاربران بدون تبلیغ به استفاده از اپ شما روی آورده‌اند.

 البته باید در نظر داشت که بخشی از نصب‌های رد شده نیز در ترکر ارگانیک گنجانده می‌شوند که آمار این نصب‌ها قابل بررسی است.
    
<br>

### ایونت

به رویدادهایی گفته می‌شود که در یک اپلیکیشن تنظیم می‌شوند و به شما کمک می‌کند تا بتوانید **رفتار** کاربر خود را بهتر بررسی کنید و براساس آنها برای توسعه محصول و کمپین خود تصمیم بگیرید. این رویدادها به دو دسته سیستمی (پیش‌فرض چابک) و سفارشی (خودتان با توجه به محصول خود می‌توانید تصمیم بگیرید مثلا فروشگاه‌ها رویداد سفارش و خرید را کلیدی می‌دانند) تقسیم می‌شوند.

<br>

### نرخ حذف

هر بار که اپلیکیشن شما از یک دستگاه حذف می‌شود، در چابک یک حذف شمرده می‌شود.

<br>

### نرخ ریزش

در چابک یک کاربر ممکن است با چند دستگاه (مثلا تبلت یا موبایل یا کامپیوتر رومیزی و…) شناخته شود. اگر کاربر **تمامی راه‌های ارتباطی با محصول شما را حذف کند**، در چابک یک ریزش شمرده می‌شود.

<br>

### پنجره اتریبیوشن

به محدوده زمانی که طول می‌کشد تا کاربر یک عمل (Action) را انجام دهد گفته می‌شود. باید در نظر داشت که عمدتا این پنجره برای نصب در نظر گرفته می‌شود، طوری که می‌توانید تعیین کنید چه مقدار زمان بین کلیک و نصب برای شما قابل قبول است.

<br><br>

## شروع به کار
---

برای استفاده از چابک در اجرای کمپین‌های خود باید در ابتدا باید **SDK** چابک را اپلیکیشن یا وب سایت خود پیاده کنید. برای مشاهده مستندات فنی [اینجا](/android/sdk-setup.html) را کلیک کنید.

### ساخت ترکر

قبل از ساختن ترکر بهتر است با انواع آن آشنا شویم:

### انواع ترکر

- ترکرهای ساده

این نوع ترکرها در هر جایی قابل استفاده هستند و شما می‌توانید تمامی موارد از قبل تنظیم شده را در اینجا بشمارید.

-  ترکرهای نتورک‌های خاص (شبکه‌های تبلیغاتی)

در صورتی که بخواهید با یک اد نتورک خاص در ایران، کمپین تبلیغات اجرا کنید، چابک می‌تواند برای بهبود کیفیت کمپین شما پارامترهای مورد نظر اد نتورک را به آنها بدهد تا بتوانند با استفاده از این کمپین‌ها کیفیت کمپین شما را بهتر کنند.

- ترکر گوگل ادز

چابک می‌تواند به شما کمک کند که نصب‌هایی که از طریق گوگل ادز یا UAC (Universal Ad Campaign) اجرا می‌کنید را بررسی کنید. برای مطالعه موارد تکمیلی به بخش [نحوه شمارش ترکر](/android/tracker.html#نحوه-شمارش-و-کارکرد-چابک) مراجعه کنید.
  
- ترکر کافه بازار

چابک می‌تواند به شما کمک کند که نصب‌هایی که از طریق کافه بازار یا تپسل اجرا می‌کنید را بررسی کنید. برای مطالعه موارد تکمیلی به بخش نحوه شمارش ترکر مراجعه کنید.

### مراحل ساخت یک ترکر

ساخت ترکر از طریق پنل انجام می‌شود. برای مشاهده نحوه ساخت ترکر می‌توانید به [مستندات پنل](/panel/tracker.html#%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF-%D8%AA%D8%B1%DA%A9%D8%B1) مراجعه کنید.

**نمونه لینک ترکر چابک**:  
  
حساب‌ رایگان:  
  
```javascipt  
https://sand.chabok.io/JY@4sc  
```    
حساب عملیاتی:  
  
```javascipt  
https://a.chabok.io/JY@4sc  
```    
<br>

#### سطح بندی ترکر

برای اینکه بتوانید به کمپین‌های خود نظم و دقت بیشتری بدهید تا در هنگام بررسی آمارها تحلیل‌های درست‌تری داشته باشید باید بتوانید ترکر خود را به شکل اصولی سطح بندی کنید.

<br><br>

## رصد ایونت‌ها (رفتار یا اهداف تبلیغ)
---
برای پیاده‌سازی به صفحه [رصد رفتار درون‌برنامه‌ای](/android/behavior-tracking.html) مراجعه کنید. پس از آن با انواع ایونت‌ها در چابک آشنا می‌شویم:

### ۱. ایونت‌های سیستمی (موجود در چابک)

ایونت‌هایی که به طور پیش فرض بدون نیاز به پیاده‌سازی خاصی تنها با استفاده از چابک بررسی می‌شوند. مثلا اولین ورود، اطلاعات گوشی و… .

<br>

### ۲. ایونت‌های غیر سیستمی یا سفارشی

این ایونت‌ها **توسط شما تعریف و پیاده‌سازی می‌شوند**. شما می‌توانید تا سقف ۳۰۰ ایونت و ۱۰۰ زیر ایونت یا اتریبیوت در اپلیکیشن خود داشته باشید.

یکی از مهم‌ترین بخش‌هایی که می‌تواند به شما در تحلیل اپ به شما کمک کند، ایونت‌های سفارشی است. هرچه آن‌ها دقیق‌تر انتخاب شوند، می‌توانند به شما کمک کنند تا بتوانید هم رفتار کاربران را به درستی تحلیل کنید و هم بتوانید در زمان تعامل مجدد (re-engage) کردن آنها با موثرتر عمل کنید.

<br><br>

## نحوه شمارش و کارکرد چابک
---

### نحوه کارکرد چابک برای شمارش نصب و بقیه ایونت‌ها

نصب از دید چابک زمانی اتفاق می‌افتد که کاربر برای اولین بار اپ شما را باز کند. نصب (یا هر ایونت دیگر) به آخرین ترکری که کاربر قبل از باز کردن اپلیکیشن روی آن کلیک کرده باشد، نسبت داده می‌شود.

<br>

### نحوه شمارش نصب‌های کافه بازار و دلایل تفاوت آمار
یک دلیل عمده اختلاف تعداد نصب کافه بازار و چابک همین تفاوت در معیار شمارش است.
در کافه بازار نصب زمانی شمرده می‌شود که کاربر بر روی دکمه نصب کلیک کرده باشد. اما همونطور که قبلا به آن اشاره شد، در چابک نصب وقتی شمرده می‌شود که کاربر برای اولین بار اپلیکیشن را باز کند.

بنابراین وقتی شما برای نصب اپ در استور کافه بازار کلیک می‌کنید، لزوما اپ را نصب نمی‌کنید. و در صورت نصب نیز ممکن است همان لحظه اپ را باز نکنید یا حتی بعد از مدتی بدون باز کردن آن را پاک کنید. در اینجا کافه بازار برای شما یک نصب را می‌شمارد اما چابک نمی‌شمرد.

 
عمدتا کافه‌بازار تعداد نصب بیشتری نسبت به چابک می‌شمارد.

<br>

### نحوه شمارش نصب‌های گوگل ادز و دلایل تفاوت آمار

استور گوگل پلی نیز مانند بازار زمانی یک نصب را برای شما می‌شمارد که کاربر بر روی دکمه نصب کلیک کند. بنابراین بدیهی است که آمار نصب گوگل پلی با چابک تفاوت داشته باشد.

در مستندات گوگل پلی به تفصیل دلایل این اختلاف مشخص شده است، کلیدی ترین موارد به شرح زیر است:

۱. گوگل آمار نصب را با تاخیر به روز می‌کند. با توجه به مستندات گوگل، ممکن است تا ۳۰ روز تعداد نصب‌ها تغییر داشته باشند. یعنی ممکن است آمار نصب ۳۰ روز گذشته در گوگل پلی افزایش داشته باشد. اما لزوما نصب‌های شمرده شده توسط گوگل ادز در چابک نیز شمرده نمی‌شوند.

۲. پنل گوگل ادز با تاخیر نسبتا زیادی به روز می‌شود. در مستندات خود گوگل به ۹ ساعت اشاره شده است اما در پنل گوگل ادز به ۲۴ ساعت تاخیر در به روز رسانی آمار نیز اشاره شده است.

۳. از آنجایی که اکثر پنل‌های گوگل ادز در خارج از ایران قرار دارند، منطقه زمانی متفاوت آن پنل با ایران باعث می‌شود تا روزهای پنل چابک با پنل گوگل ادز متفاوت باشد.

۴. در صورتی که کاربری بر روی لینک تبلیغ گوگل ادز کلیک کند اما نصب نکند و بعد از مدتی (کمتر از ۳۰ روز) از طریق سرچ در گوگل اپ شما را نصب کند، گوگل ادز این نصب را نصب پولی گوگل ادز محسوب می‌کند در حالیکه در ادجاست، برنچ، گوگل آنالیتیکس و چابک این نصب ارگانیک محسوب می‌شود.

#### پیاده‌سازی شمارش نصب از گوگل پلی

برای انجام این کار باید از `INSTALL_REFERRER` intent اندروید استفاده کنید. این Referrer وظیفه اطلاع رسانی نصب از گوگل پلی را  به SDK چابک دارد. فقط کافیست اپلیکیشن شما آن را دریافت کند. بنابراین اطمینان یابید که کد زیر در `build.gradle` شما اضافه شده باشد:  
  
```java  
implementation 'com.android.installreferrer:installreferrer:1.0'  
```  
<br>  

### نحوه شمارش نصب‌ها در پلتفرم‌های مشابه کافه بازار و پلی استور

به طور کلی بخش بزرگی از اختلاف نصب موجود در چابک و بقیه پنل‌ها بخاطر تفاوت در تعریف نصب است. در چابک بخاطر تمرکز بر کاربران فعال، تلاش شده است تا زمانی نصب شمرده شود که کاربر حداقل یک بار اپ را باز کرده و بدون دیدن محیط اپ آن را حذف نکرده است.

#### پیاده‌سازی شمارش نصب از استورهای غیر از گوگل پلی  (Third-Party App Stores)  
  
این کار را چابک با دو روش **استفاده از روش Referrer** و **آی‌دی ترکر** انجام می‌دهد.   
  
##### روش Referrer  
  
در صورتی که می‌خواهید از استورهای غیر از گوگل پلی که Referrer را **پشتیبانی می‌کنند** ترک کنید، تگ `receiver` را در کلاس `application` فایل `AndroidManifest.xml` خود قرار دهید:   
  
```java  
<receiver  
    android:name="com.adpdigital.push.ChabokReferrerReceiver"  
    android:permission="android.permission.INSTALL_PACKAGES"  
    android:exported="true">  
       <intent-filter>  
            <action android:name="com.android.vending.INSTALL_REFERRER" />  
        </intent-filter>  
</receiver>  
```  
  
زمانی که شما دریافت Referrer را در اپلیکیشن خود پیاده‌سازی کردید، اطلاعات کمپین را دریافت می‌کند و به شما انتقال خواهد داد.  
  
از طریق Referrer شما اطلاعات کلیدی ترکر خود مانند منبع نصب، آی‌دی ترکر و سطح ترکر را ارسال می‌کنید.  
  
##### روش آی‌دی یا دیفالت ترکر (Pre-Install Campaigns)  
  
اگر هم استورها Referrer را کلا **پشتیبانی نکنند** شما همچنان می‌توانید منبع (Source) نصب را در کمپین خود بفهمید. برای انجام این کار باید در ابتدا ترکر خود را در پنل ایجاد کنید، **آی‌دی ترکر** را در متد زیر قرار دهید و پس از خروجی apk گرفتن آن را در استور مورد نظر بگذارید.   
  
```java  
AdpPushClient.setDefaultTracker("YOUR_TRACKER_ID");  
```  
  
>`نکته:` دقت داشته باشید که `TRACKER_ID` شناسه ۶ کاراکتری است که در لینک ترکر شما وجود دارد. به عنوان مثال در لینک `https://sand.chabok.io/JY@4sc` آی‌دی ترکر `JY@4sc` می‌باشد. این آی‌دی را می‌توانید از پنل>ترکر>جزئیات ترکر مانند تصویر زیر کپی کنید:  
  
![عکس مربوط](http://uupload.ir/files/bjbc_tracker-analytics-s.png)  
  
<br>

#### شمارش جستجوی ارگانیک گوگل  
  
گوگل به کاربران امکان می‌دهد تا با جستجوی اپلیکیشن در موتور جستجوی خود و کلیک روی آیکون آن به **گوگل پلی** بروند و آنجا به طور مستقیم نصب کنند.  
  
شما می‌توانید **کلید واژه‌‌ای** که کاربر در **گوگل** جستجو کرده است را داشته باشید. چابک این کلید واژه را در سطح `campaign` ترکر ایجاد می‌کند.   
  
علاوه بر آن، چابک پارامتر `utm_medium` را در سطح `adgroup` ایجاد می‌کند. این پارامتر همان معیار شمارش است.  
  
>`نکته:` دقت داشته باشید که برای استفاده از این قابلیت باید حتما ‍‍`referrer` را پیاده‌سازی کرده باشید. 

<br>

### مراحل کار ترکر   

ترکر چابک پس از کلیک شدن به ترتیب مراحل زیر را طی می‌کند تا **منبع نصب** را تعیین نماید.   

<br>  
  
![عکس مربوطه](http://uupload.ir/files/06kr_tracker-function.png)  
  
<br>  
  
به طور مثال فرض می‌کنیم شما کاربر کافه بازار هستید و برای اپلیکیشنتان **هم از تبلیغات کافه بازار (سرچ اد)** استفاده کرده‌اید و هم روی APK خود **شناسه** ترکر را گذاشته‌اید. در این صورت اگر مخاطبتان اپلیکیشنتان را از طریق تبلیغ دریافت کند، ترکر چابک نصب را روی تبلیغات کافه‌ بازار می‌اندازد و اگر مخاطب خودش اپلیکیشن شما را پیدا کند، چابک آن را روی دیفالت ترکری که از قبل ساخته بودید می‌اندازد.

<br><br>
      
### کال‌بک‌های ترکر (Callback)  
--- 

در صورتی هم که می‌خواهید داده‌های ترکر را در سیستم‌های دیگر از جمله سرورهای خود دریافت کنید می‌توانید از کال‌بک استفاده کنید. این کار را می‌توانید از پنل هنگام ایجاد ترکر جدید انجام دهید. به این ترتیب لینکی که می‌خواهید زمان رخ دادن رویداد (کلیک یا نصب) فرخوانی شود را وارد می‌کنید.   
  
همچنین شما می‌توانید در کال‌بک خود از پارامترهایی برای اطلاعات بیشتر از مبدا رویداد کسب کنید. برای مشاهده این پارامترها و نمونه لینک کال‌بک می‌توانید به مستندات [پنل](/panel/tracker.html#کالبک) مراجعه کنید.  

<br><br>

### قابلیت دعوت دوستان  
---

یکی از راههای موثر برای جذب کاربران به اپلیکیشن، ارسال لینک دعوت به آن‌هاست. روش‌های زیادی برای ارسال لینک دعوت به کاربران وجود دارد که  برای مثال یک نمونه از آن را توضیح خواهیم داد.   
  
فرض کنید یک تعداد از کاربران، اپلیکیشن شرکت در رویداد را نصب  و در رویدادی ثبت نام کردند، برای جذب کاربران بیشتر در اپلیکیشن نیازست لینک دعوتی به آن‌ها ارسال کنید تا لینک را با دوستان خود به اشتراک بگذارند، با کلیک کاربران جدید بر روی لینک دعوت  به صفحه نصب اپلیکیشن به طور خودکار هدایت می‌شوند و به طور مثال کاربران دعوت‌کننده نیز کد تخفیفی برای شرکت در رویدادهای بعدی دریافت خواهند کرد.   
  
<h4>ایجاد لینک دعوت دوستان</h4>  
  
برای ایجاد لینک دعوت دوستان از طریق خود اپلیکیشن کافیست در انتهای لینک ترکر نصب، پارامتر `lable` را اضافه کنید.  
  
برای اینکه متوجه شوید نصب اپلیکیشن انجام شده و دعوت‌نامه  به کاربر دیگر ارسال شده، نیاز به فراخوانی متد `setDeferredDataListener` و پیاده‌سازی متد `onReferralReceived` به کمک کد زیر را دارید.  
  
  
```java  
AdpPushClient.get().setDeferredDataListener(new DeferredDataListener() {  
    @Override  
    public boolean launchReceivedDeeplink(Uri deeplink) {  
        return false;  
    }  
  
    @Override  
    public void onReferralReceived(String label) {  
        // send label to your server  
    }  
});  
```  
  
>`نکته`: **lable** مقداری هست که در انتهای لینک ترکر نصب گذاشته می‌شود و با هر بار کلیک کاربر بر روی لینک، کاربر به صفحه نصب اپلیکیشن هدایت می‌شود. این مقدار از طریق فراخوانی متد گفته شده قابل دریافت است.  
  
  
  اگر قصد دارید لینک دعوت به دوستان را در حساب آزمایشی به کاربران ارسال کنید، کافیست لینک ترکر خود را به فرمت زیر در اپلیکیشن‌تان استفاده کنید.  
  
```java  
https://sand.chabok.io/GgKoAT?label=user_1001  
```  
اگر در حساب عملیاتی، خواستید لینک را به کاربران ارسال کنید باید از فرمت زیر در اپلیکیشن‌‌تان استفاده کنید.  
  
```java  
https://a.chabok.io/GgKoAT?label=user_1001  
```  
  
>`نکته`: برای پیاده‌سازی قابلیت دعوت دوستان کافیست در انتهای لینک ترکر نصب به جای user_1001، شناسه کاربری شخص دعوت‌کننده را قرار دهید.   

<br><br>  
  
### مکانیزم ضد تقلب (Fraud Prevention)  
---

SDK چابک به گونه‌ای پیاده‌سازی شده است که امکان تقلب و نصب غیر واقعی در روش‌های مبتنی بر نصب و رفتار (CPA و CPI) را به طور کامل از بین می‌برد. علاوه بر آن، به هیج وجه فراخوانی و رصد رویداد‌های چابک قابل دستکاری نیستند.   
  
مواردی که چابک برای حذف تقلب انجام می‌دهد عبارتند از:  
  
- **IP Filtering**:  
  
آی‌پی کاربر را در زمان کلیک و نصب تطبیق می‌دهد، جلوی نصب‌های متعدد با یک آی‌پی را می‌گیرد و همچنین آی‌پی‌های ناشناخته را رد می‌کند.  
  
- **User Verification**:  
  
با توجه به ساختار کاربر محور بودن سیستم چابک، تمام اطلاعات کاربر در کلیک و نصب را مقایسه می‌کند تا واقعی بودن کاربر جذب شده مشخص شود.  
  
- **SDK Signature**:  
  
روی SDK امضای خاصی را می‌گذارد تا هنگام کلیک دریافت شود و پس از نصب با اپلیکیشن شما تطبیق داده شود. همچنین یکی از راه‌های مقابله با **SDK Spoofing** است. SDK Spoofing یکی از راه‌های تقلب است که نصب‌ها را روی دستگاه‌های واقعی شبیه‌سازی می‌کند و آن را جزو نصب‌های کمپین محاسبه می‌نماید. این کار معمولا از اپلیکیشن‌های دیگر روی دستگاه صورت می‌گیرد و نصب‌های بی‌شمار غیر واقعی را وارد کمپین‌ شما می‌کند.  
  
  
- **Server to Server Verification**:  
  
اطلاعات کاربر را هنگام کلیک جمع‌آوری می‌کند و با اطلاعاتی که سرور شما در هنگام نصب دریافت می‌کند اعتبارسنجی می‌نماید؛ در صورت عدم تطابق، نصب را رد می‌کند.  
  
- **TTI**:  
  
زمان قابل قبول بین کلیک و نصب است. چابک به طور خودکار فاصله زمانی بسیار کوتاه را رد می‌کند و همینطور در صورتی که از محدوده‌ای که شما تعیین کرده‌اید بیشتر شود ([محدوده اتریبیوشن](/panel/tracker.html#محدوده-اتریبیوشن))، نصب شمرده نخواهد شد.  
  
- **Two-Phase Authentication**:  
  
احراز هویت برای تشخیص واقعی بودن کاربر در هنگام نصب است. در چابک این کار از طریق ارسال پیام کوتاه انجام می‌شود.  
  
